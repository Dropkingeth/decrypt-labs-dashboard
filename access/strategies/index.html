<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Trading Strategies - Decrypt Labs</title>
    <script src="https://cdn.jsdelivr.net/npm/ethers@6.9.0/dist/ethers.umd.min.js"></script>
    <style>
        * { margin: 0; padding: 0; box-sizing: border-box; }
        
        :root {
            --bg-dark: #0a0b1e;
            --bg-card: #12132d;
            --bg-hover: #1a1b3a;
            --bg-input: #1a1b3a;
            --accent: #6366f1;
            --accent-light: #818cf8;
            --success: #10b981;
            --warning: #f59e0b;
            --danger: #ef4444;
            --text: #e2e8f0;
            --text-dim: #94a3b8;
            --gold: #ffd700;
            --diamond: #b9f2ff;
        }
        
        body {
            font-family: 'Inter', -apple-system, BlinkMacSystemFont, sans-serif;
            background: var(--bg-dark);
            color: var(--text);
            min-height: 100vh;
            background-image: 
                radial-gradient(ellipse at top, rgba(99, 102, 241, 0.1) 0%, transparent 50%),
                radial-gradient(ellipse at bottom, rgba(139, 92, 246, 0.1) 0%, transparent 50%);
        }
        
        .container {
            max-width: 1100px;
            margin: 0 auto;
            padding: 2rem;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .logo {
            font-size: 1.5rem;
            font-weight: 700;
            background: linear-gradient(135deg, #6366f1, #a855f7);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
            text-decoration: none;
        }
        
        .connect-btn {
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            border: none;
            padding: 0.75rem 1.5rem;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.2s, box-shadow 0.2s;
        }
        
        .connect-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 40px rgba(99, 102, 241, 0.3);
        }
        
        .hero {
            text-align: center;
            padding: 2rem 0 3rem;
        }
        
        .hero h1 {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            background: linear-gradient(135deg, #fff, #94a3b8);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        .hero p {
            color: var(--text-dim);
            font-size: 1.125rem;
            max-width: 600px;
            margin: 0 auto;
        }
        
        .tier-notice {
            text-align: center;
            padding: 1.5rem;
            background: var(--bg-card);
            border-radius: 16px;
            margin-bottom: 2rem;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }
        
        .tier-badge {
            display: inline-block;
            padding: 0.5rem 1rem;
            border-radius: 20px;
            font-weight: 600;
            margin-bottom: 0.5rem;
        }
        
        .tier-gold { background: rgba(255, 215, 0, 0.2); color: var(--gold); }
        .tier-diamond { background: rgba(185, 242, 255, 0.2); color: var(--diamond); }
        .tier-locked { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        
        .strategies-grid {
            display: grid;
            gap: 1.5rem;
        }
        
        .strategy-card {
            background: var(--bg-card);
            border-radius: 20px;
            overflow: hidden;
            border: 1px solid rgba(99, 102, 241, 0.2);
            transition: transform 0.3s, box-shadow 0.3s;
        }
        
        .strategy-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 20px 40px rgba(0, 0, 0, 0.3);
        }
        
        .strategy-card.locked {
            opacity: 0.6;
        }
        
        .strategy-card.locked .strategy-content {
            filter: blur(4px);
            pointer-events: none;
        }
        
        .strategy-header {
            padding: 1.5rem;
            background: linear-gradient(135deg, rgba(99, 102, 241, 0.1), rgba(139, 92, 246, 0.1));
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
            gap: 1rem;
        }
        
        .strategy-title {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }
        
        .strategy-icon {
            font-size: 2rem;
        }
        
        .strategy-name {
            font-size: 1.5rem;
            font-weight: 700;
        }
        
        .strategy-meta {
            display: flex;
            gap: 0.75rem;
        }
        
        .meta-badge {
            padding: 0.25rem 0.75rem;
            border-radius: 20px;
            font-size: 0.75rem;
            font-weight: 600;
            text-transform: uppercase;
        }
        
        .risk-low { background: rgba(16, 185, 129, 0.2); color: var(--success); }
        .risk-medium { background: rgba(245, 158, 11, 0.2); color: var(--warning); }
        .risk-high { background: rgba(239, 68, 68, 0.2); color: var(--danger); }
        
        .tier-required {
            background: rgba(99, 102, 241, 0.2);
            color: var(--accent-light);
        }
        
        .strategy-content {
            padding: 1.5rem;
        }
        
        .strategy-description {
            color: var(--text-dim);
            line-height: 1.7;
            margin-bottom: 1.5rem;
        }
        
        .strategy-stats {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 1rem;
            margin-bottom: 1.5rem;
        }
        
        .stat-box {
            text-align: center;
            padding: 1rem;
            background: rgba(255, 255, 255, 0.05);
            border-radius: 12px;
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent-light);
        }
        
        .stat-label {
            font-size: 0.75rem;
            color: var(--text-dim);
            margin-top: 0.25rem;
        }
        
        .strategy-details h4 {
            font-size: 1rem;
            margin-bottom: 0.75rem;
            color: var(--text);
        }
        
        .strategy-details ul {
            list-style: none;
            color: var(--text-dim);
        }
        
        .strategy-details li {
            padding: 0.5rem 0;
            padding-left: 1.5rem;
            position: relative;
        }
        
        .strategy-details li::before {
            content: '‚Üí';
            position: absolute;
            left: 0;
            color: var(--accent);
        }
        
        .lock-overlay {
            display: none;
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(10, 11, 30, 0.9);
            align-items: center;
            justify-content: center;
            flex-direction: column;
            gap: 1rem;
            z-index: 10;
        }
        
        .strategy-card.locked .lock-overlay {
            display: flex;
        }
        
        .strategy-card {
            position: relative;
        }
        
        .lock-icon {
            font-size: 3rem;
        }
        
        .lock-text {
            color: var(--text-dim);
        }
        
        .upgrade-link {
            color: var(--accent-light);
            text-decoration: none;
        }
        
        .upgrade-link:hover {
            text-decoration: underline;
        }
        
        .request-access-btn {
            margin-top: 1rem;
            padding: 0.75rem 1.5rem;
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            border: none;
            border-radius: 12px;
            color: white;
            font-weight: 600;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .request-access-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 30px rgba(99, 102, 241, 0.3);
        }
        
        .request-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0, 0, 0, 0.8);
            z-index: 1000;
            align-items: center;
            justify-content: center;
        }
        
        .request-modal.active {
            display: flex;
        }
        
        .modal-content {
            background: var(--bg-card);
            padding: 2rem;
            border-radius: 20px;
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(99, 102, 241, 0.2);
        }
        
        .modal-close {
            float: right;
            background: none;
            border: none;
            color: var(--text-dim);
            font-size: 1.5rem;
            cursor: pointer;
        }
        
        .modal-title {
            font-size: 1.5rem;
            margin-bottom: 0.5rem;
        }
        
        .modal-desc {
            color: var(--text-dim);
            margin-bottom: 1.5rem;
        }
        
        .form-group {
            margin-bottom: 1.5rem;
        }
        
        .form-label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 600;
        }
        
        .form-input {
            width: 100%;
            padding: 1rem;
            background: var(--bg-input);
            border: 2px solid rgba(99, 102, 241, 0.2);
            border-radius: 12px;
            color: var(--text);
            font-size: 1rem;
        }
        
        .form-input:focus {
            outline: none;
            border-color: var(--accent);
        }
        
        .form-hint {
            font-size: 0.8rem;
            color: var(--text-dim);
            margin-top: 0.5rem;
        }
        
        .form-hint a {
            color: var(--accent-light);
        }
        
        .submit-btn {
            width: 100%;
            padding: 1rem;
            background: linear-gradient(135deg, var(--accent), #8b5cf6);
            border: none;
            border-radius: 12px;
            color: white;
            font-size: 1rem;
            font-weight: 600;
            cursor: pointer;
        }
        
        .submit-btn:disabled {
            opacity: 0.5;
            cursor: not-allowed;
        }
        
        .success-state {
            text-align: center;
            padding: 1rem;
        }
        
        .success-state h3 {
            color: var(--success);
            margin-bottom: 0.5rem;
        }
        
        @media (max-width: 768px) {
            .container { padding: 1rem; }
            .hero h1 { font-size: 1.75rem; }
            .strategy-stats { grid-template-columns: repeat(2, 1fr); }
            .strategy-header { flex-direction: column; align-items: flex-start; }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <a href="/" class="logo">üîê Decrypt Labs</a>
            <button class="connect-btn" id="connectBtn">Connect Wallet</button>
        </header>
        
        <div class="hero">
            <h1>Trading Strategies</h1>
            <p>ICT-based automated trading strategies. Gold tier gets 1 strategy, Diamond unlocks all 4.</p>
        </div>
        
        <div class="tier-notice" id="tierNotice">
            <div class="tier-badge tier-locked" id="accessBadge">Connect Wallet</div>
            <p id="accessText">Connect your wallet to check strategy access</p>
        </div>
        
        <div class="strategies-grid" id="strategiesGrid">
            <!-- Strategy 0: OTE Silver Bullet -->
            <div class="strategy-card" id="strat0" data-tier="2">
                <div class="lock-overlay">
                    <span class="lock-icon">üîí</span>
                    <span class="lock-text">Requires Gold Tier</span>
                    <a href="/access/" class="upgrade-link">Upgrade Access ‚Üí</a>
                </div>
                <div class="strategy-header">
                    <div class="strategy-title">
                        <span class="strategy-icon">üéØ</span>
                        <span class="strategy-name">OTE Silver Bullet</span>
                    </div>
                    <div class="strategy-meta">
                        <span class="meta-badge risk-medium">Medium Risk</span>
                        <span class="meta-badge tier-required">Gold+</span>
                    </div>
                </div>
                <div class="strategy-content">
                    <p class="strategy-description">
                        The OTE Silver Bullet strategy trades Optimal Trade Entry setups during high-probability kill zones. 
                        It identifies liquidity sweeps followed by displacement and targets the 62-79% Fibonacci retracement 
                        zone for entries. Designed for consistent daily execution with defined risk parameters.
                    </p>
                    <div class="strategy-stats">
                        <div class="stat-box">
                            <div class="stat-value">68%</div>
                            <div class="stat-label">Win Rate</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">2.1</div>
                            <div class="stat-label">Avg R:R</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">3-5</div>
                            <div class="stat-label">Trades/Week</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">$150</div>
                            <div class="stat-label">Avg P&L/Trade</div>
                        </div>
                    </div>
                    <div class="strategy-details">
                        <h4>Entry Criteria</h4>
                        <ul>
                            <li>Liquidity sweep of previous high/low</li>
                            <li>Displacement candle with FVG creation</li>
                            <li>Entry at 62-79% OTE zone</li>
                            <li>Kill zone timing (NY AM, London)</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Strategy 1: FVG+IFVG -->
            <div class="strategy-card" id="strat1" data-tier="3">
                <div class="lock-overlay">
                    <span class="lock-icon">üîí</span>
                    <span class="lock-text">Requires Diamond Tier</span>
                    <a href="/access/" class="upgrade-link">Upgrade Access ‚Üí</a>
                </div>
                <div class="strategy-header">
                    <div class="strategy-title">
                        <span class="strategy-icon">üìä</span>
                        <span class="strategy-name">FVG + IFVG</span>
                    </div>
                    <div class="strategy-meta">
                        <span class="meta-badge risk-medium">Medium Risk</span>
                        <span class="meta-badge tier-required">Diamond</span>
                    </div>
                </div>
                <div class="strategy-content">
                    <p class="strategy-description">
                        Combines Fair Value Gap entries with Inverse Fair Value Gap confirmations for higher probability setups.
                        Waits for price to return to unfilled gaps and uses IFVG as the trigger for entry, reducing false signals
                        and improving timing precision.
                    </p>
                    <div class="strategy-stats">
                        <div class="stat-box">
                            <div class="stat-value">72%</div>
                            <div class="stat-label">Win Rate</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">1.8</div>
                            <div class="stat-label">Avg R:R</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">4-6</div>
                            <div class="stat-label">Trades/Week</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">$120</div>
                            <div class="stat-label">Avg P&L/Trade</div>
                        </div>
                    </div>
                    <div class="strategy-details">
                        <h4>Entry Criteria</h4>
                        <ul>
                            <li>Identify unfilled FVG on higher timeframe</li>
                            <li>Wait for price to enter FVG zone</li>
                            <li>IFVG formation as entry trigger</li>
                            <li>Stop below/above FVG boundary</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Strategy 2: OTE Refined High -->
            <div class="strategy-card" id="strat2" data-tier="3">
                <div class="lock-overlay">
                    <span class="lock-icon">üîí</span>
                    <span class="lock-text">Requires Diamond Tier</span>
                    <a href="/access/" class="upgrade-link">Upgrade Access ‚Üí</a>
                </div>
                <div class="strategy-header">
                    <div class="strategy-title">
                        <span class="strategy-icon">üî•</span>
                        <span class="strategy-name">OTE Refined (Aggressive)</span>
                    </div>
                    <div class="strategy-meta">
                        <span class="meta-badge risk-high">High Risk</span>
                        <span class="meta-badge tier-required">Diamond</span>
                    </div>
                </div>
                <div class="strategy-content">
                    <p class="strategy-description">
                        High-conviction version of OTE with larger position sizing on A+ setups only. Trades selectively on 
                        optimal days (Tuesday-Thursday) with additional confluence filters. Higher risk, higher reward profile
                        for experienced traders comfortable with drawdowns.
                    </p>
                    <div class="strategy-stats">
                        <div class="stat-box">
                            <div class="stat-value">75%</div>
                            <div class="stat-label">Win Rate</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">2.5</div>
                            <div class="stat-label">Avg R:R</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">1-3</div>
                            <div class="stat-label">Trades/Week</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">$300</div>
                            <div class="stat-label">Avg P&L/Trade</div>
                        </div>
                    </div>
                    <div class="strategy-details">
                        <h4>Entry Criteria</h4>
                        <ul>
                            <li>A+ setup confluence only</li>
                            <li>Tuesday-Thursday execution</li>
                            <li>HTF bias alignment required</li>
                            <li>2x standard position size</li>
                        </ul>
                    </div>
                </div>
            </div>
            
            <!-- Strategy 3: OTE Refined Low -->
            <div class="strategy-card" id="strat3" data-tier="3">
                <div class="lock-overlay">
                    <span class="lock-icon">üîí</span>
                    <span class="lock-text">Requires Diamond Tier</span>
                    <a href="/access/" class="upgrade-link">Upgrade Access ‚Üí</a>
                </div>
                <div class="strategy-header">
                    <div class="strategy-title">
                        <span class="strategy-icon">üõ°Ô∏è</span>
                        <span class="strategy-name">OTE Refined (Conservative)</span>
                    </div>
                    <div class="strategy-meta">
                        <span class="meta-badge risk-low">Low Risk</span>
                        <span class="meta-badge tier-required">Diamond</span>
                    </div>
                </div>
                <div class="strategy-content">
                    <p class="strategy-description">
                        Capital preservation focused strategy with reduced position sizing and tighter risk controls.
                        Ideal for funded account challenges where consistency beats aggression. Prioritizes protecting
                        gains over maximizing them.
                    </p>
                    <div class="strategy-stats">
                        <div class="stat-box">
                            <div class="stat-value">70%</div>
                            <div class="stat-label">Win Rate</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">1.5</div>
                            <div class="stat-label">Avg R:R</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">3-4</div>
                            <div class="stat-label">Trades/Week</div>
                        </div>
                        <div class="stat-box">
                            <div class="stat-value">$75</div>
                            <div class="stat-label">Avg P&L/Trade</div>
                        </div>
                    </div>
                    <div class="strategy-details">
                        <h4>Entry Criteria</h4>
                        <ul>
                            <li>Standard OTE criteria + extra filter</li>
                            <li>0.5x standard position size</li>
                            <li>Tighter stop loss (reduced risk)</li>
                            <li>Early profit taking at 1R</li>
                        </ul>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- Request Access Modal -->
        <div class="request-modal" id="requestModal">
            <div class="modal-content">
                <button class="modal-close" onclick="closeModal()">&times;</button>
                <h2 class="modal-title" id="modalTitle">üéØ Request Strategy Access</h2>
                <p class="modal-desc" id="modalDesc">Enter your TradingView username to get access to this strategy.</p>
                
                <div id="requestForm">
                    <div class="form-group">
                        <label class="form-label">TradingView Username</label>
                        <input type="text" class="form-input" id="tvUsername" placeholder="e.g. your_username">
                        <p class="form-hint">Find your username at <a href="https://www.tradingview.com/u/" target="_blank">tradingview.com/u/</a></p>
                    </div>
                    <button class="submit-btn" id="submitBtn" onclick="submitRequest()">Request Access</button>
                </div>
                
                <div class="success-state" id="successState" style="display: none;">
                    <h3>‚úÖ Request Submitted!</h3>
                    <p style="color: var(--text-dim);">We'll add you to the strategy within 24 hours. Check your TradingView notifications.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const CONTRACTS = {
            cipher: "0x85075b6E79FEB545F30e60151f467ff17FD3E8BB",
            tierGate: "0x08c7C46434B8d0c5cEa538278711df0051C0fCA1"
        };
        
        const ERC20_ABI = ["function balanceOf(address) view returns (uint256)"];
        const TIERGATE_ABI = ["function getUserTier(address) view returns (uint8)"];
        
        let provider, signer, userAddress;
        
        async function connectWallet() {
            if (!window.ethereum) {
                alert('Please install MetaMask!');
                return;
            }
            
            try {
                provider = new ethers.BrowserProvider(window.ethereum);
                await provider.send("eth_requestAccounts", []);
                signer = await provider.getSigner();
                userAddress = await signer.getAddress();
                
                const network = await provider.getNetwork();
                if (network.chainId !== 84532n) {
                    await window.ethereum.request({
                        method: 'wallet_switchEthereumChain',
                        params: [{ chainId: '0x14a34' }]
                    });
                }
                
                document.getElementById('connectBtn').textContent = userAddress.slice(0, 6) + '...' + userAddress.slice(-4);
                
                await checkAccess();
            } catch (error) {
                console.error('Connection error:', error);
            }
        }
        
        async function checkAccess() {
            const tierGate = new ethers.Contract(CONTRACTS.tierGate, TIERGATE_ABI, provider);
            const tier = await tierGate.getUserTier(userAddress);
            
            const tierNum = Number(tier);
            const badge = document.getElementById('accessBadge');
            const text = document.getElementById('accessText');
            
            if (tierNum === 0) {
                badge.textContent = 'üîí No Access';
                badge.className = 'tier-badge tier-locked';
                text.textContent = 'You need Gold tier (500k CIPHER) to access strategies';
            } else if (tierNum === 1) {
                badge.textContent = 'ü•â Bronze Tier';
                badge.className = 'tier-badge tier-locked';
                text.textContent = 'Upgrade to Gold (500k CIPHER) to unlock 1 strategy';
            } else if (tierNum === 2) {
                badge.textContent = 'ü•á Gold Tier';
                badge.className = 'tier-badge tier-gold';
                text.textContent = 'You can access 1 strategy. Upgrade to Diamond for all 4!';
                // Unlock first strategy
                document.getElementById('strat0').classList.remove('locked');
            } else if (tierNum === 3) {
                badge.textContent = 'üíé Diamond Tier';
                badge.className = 'tier-badge tier-diamond';
                text.textContent = 'Full access to all strategies!';
                // Unlock all
                document.querySelectorAll('.strategy-card').forEach(c => c.classList.remove('locked'));
            }
        }
        
        let selectedStrategy = null;
        const API_URL = "https://stunning-appreciation-production-ea66.up.railway.app/api";
        
        function openRequestModal(strategyId) {
            const stratNames = ['OTE Silver Bullet', 'FVG + IFVG', 'OTE Refined (Aggressive)', 'OTE Refined (Conservative)'];
            selectedStrategy = strategyId;
            document.getElementById('modalTitle').textContent = `üéØ Request: ${stratNames[strategyId]}`;
            document.getElementById('requestForm').style.display = 'block';
            document.getElementById('successState').style.display = 'none';
            document.getElementById('requestModal').classList.add('active');
        }
        
        function closeModal() {
            document.getElementById('requestModal').classList.remove('active');
        }
        
        async function submitRequest() {
            const username = document.getElementById('tvUsername').value.trim();
            if (!username || selectedStrategy === null) return;
            
            const btn = document.getElementById('submitBtn');
            btn.disabled = true;
            btn.textContent = 'Submitting...';
            
            try {
                const request = {
                    wallet: userAddress,
                    tvUsername: username,
                    type: 'strategy',
                    strategyId: selectedStrategy,
                    timestamp: Date.now()
                };
                
                try {
                    await fetch(`${API_URL}/access-requests`, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify(request)
                    });
                } catch (e) {
                    console.log('Backend not available, storing locally');
                }
                
                localStorage.setItem(`strategy_request_${userAddress}_${selectedStrategy}`, JSON.stringify(request));
                
                document.getElementById('requestForm').style.display = 'none';
                document.getElementById('successState').style.display = 'block';
                
            } catch (error) {
                console.error('Submit error:', error);
                alert('Failed to submit. Please try again.');
            }
            
            btn.disabled = false;
            btn.textContent = 'Request Access';
        }
        
        function addRequestButtons() {
            document.querySelectorAll('.strategy-card:not(.locked)').forEach(card => {
                const stratId = parseInt(card.id.replace('strat', ''));
                const existing = card.querySelector('.request-access-btn');
                if (!existing) {
                    const details = card.querySelector('.strategy-details');
                    const btn = document.createElement('button');
                    btn.className = 'request-access-btn';
                    btn.textContent = 'üîì Request TradingView Access';
                    btn.onclick = () => openRequestModal(stratId);
                    
                    // Check if already requested
                    if (localStorage.getItem(`strategy_request_${userAddress}_${stratId}`)) {
                        btn.textContent = '‚è≥ Request Pending';
                        btn.disabled = true;
                        btn.style.opacity = '0.6';
                    }
                    
                    details.appendChild(btn);
                }
            });
        }
        
        // Override checkAccess to add buttons
        const originalCheckAccess = checkAccess;
        checkAccess = async function() {
            await originalCheckAccess();
            setTimeout(addRequestButtons, 100);
        };
        
        document.getElementById('connectBtn').addEventListener('click', connectWallet);
        
        // Add locked class by default
        document.querySelectorAll('.strategy-card').forEach(c => c.classList.add('locked'));
        
        if (window.ethereum?.selectedAddress) {
            connectWallet();
        }
    </script>
</body>
</html>
